import{K as C,r as x,m as D,j as e,L as $,$ as u,S as n}from"./app-CwlvKQfy.js";import{A}from"./AppLayout-BBPJmVwY.js";import"./ThemeToggle-CGnQ3XP8.js";function R(){const{article:t,comments:g,userLiked:y,likesCount:j,commentsCount:l,auth:s}=C().props,[d,o]=x.useState(!1),[a,c]=x.useState(y),[i,m]=x.useState(j),{data:h,setData:f,post:v,processing:p,errors:b,reset:N}=D({content:""}),k=async()=>{if(!s.user){n.visit(route("login"));return}o(!0),c(!a),m(a?i-1:i+1);try{await n.post(route("articles.like",t.id),{},{preserveState:!0,preserveScroll:!0,onFinish:()=>o(!1),onError:()=>{c(a),m(i)}})}catch{o(!1),c(a),m(i)}},w=r=>{if(r.preventDefault(),!s.user){n.visit(route("login"));return}v(route("comments.store",t.id),{preserveScroll:!0,onSuccess:()=>{N("content")}})},S=r=>{confirm("√ätes-vous s√ªr de vouloir supprimer ce commentaire ?")&&n.delete(route("comments.destroy",r),{preserveScroll:!0})},L=()=>{confirm("√ätes-vous s√ªr de vouloir supprimer cet article ?")&&n.delete(route("articles.destroy",t.id))};return e.jsxs(A,{children:[e.jsx($,{title:t.title}),e.jsxs("div",{className:"py-8 px-4 sm:px-6 lg:px-8 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(u,{href:route("articles.index"),className:"text-indigo-600 hover:text-indigo-800 text-sm font-medium mb-4 inline-flex items-center gap-2",children:"‚Üê Retour aux articles"}),s.user&&(s.user.id===t.user.id||["admin","webmaster"].includes(s.user.role))&&e.jsxs("div",{className:"flex gap-4 mt-4",children:[e.jsx(u,{href:route("articles.edit",t.id),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition text-sm font-medium",children:"‚úèÔ∏è Modifier"}),e.jsx("button",{onClick:L,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition text-sm font-medium",children:"üóëÔ∏è Supprimer"})]})]}),e.jsxs("article",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden",children:[t.image&&e.jsx("div",{className:"w-full h-96 overflow-hidden",children:e.jsx("img",{src:t.image.startsWith("http")?t.image:`/storage/${t.image}`,alt:t.title,className:"w-full h-full object-cover",onError:r=>{r.currentTarget.src="https://via.placeholder.com/800x400?text=Image+non+disponible"}})}),e.jsxs("div",{className:"p-8",children:[e.jsx("div",{className:"mb-4",children:e.jsx("span",{className:"inline-block px-3 py-1 bg-indigo-100 dark:bg-indigo-900 text-indigo-800 dark:text-indigo-200 text-sm font-semibold rounded-full",children:t.category.name})}),e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",children:t.title}),e.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400 text-sm mb-6",children:[e.jsxs("span",{children:["Par ",t.user.name]}),e.jsx("span",{className:"mx-2",children:"‚Ä¢"}),e.jsx("span",{children:new Date(t.created_at).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})})]}),t.tags&&t.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:t.tags.map(r=>e.jsxs("span",{className:"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 text-sm rounded-full",children:["#",r.name]},r.id))}),e.jsx("div",{className:"prose dark:prose-invert max-w-none mb-8",children:e.jsx("div",{className:"text-gray-700 dark:text-gray-300 leading-relaxed whitespace-pre-wrap",children:t.content})}),e.jsx("div",{className:"flex items-center justify-between py-6 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("button",{onClick:k,disabled:d,className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition ${a?"bg-red-100 text-red-700 hover:bg-red-200":"bg-gray-100 text-gray-700 hover:bg-red-100 hover:text-red-700"} ${d?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("span",{className:`text-lg ${d?"animate-pulse":""}`,children:a?"‚ù§Ô∏è":"ü§ç"}),e.jsxs("span",{children:[i," ",i<=1?"like":"likes"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[e.jsx("span",{children:"üí¨"}),e.jsxs("span",{children:[l," ",l<=1?"commentaire":"commentaires"]})]})]})})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:["Commentaires (",l,")"]}),s.user?e.jsx("form",{onSubmit:w,className:"mb-8",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[e.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Ajouter un commentaire"}),e.jsx("textarea",{id:"content",value:h.content,onChange:r=>f("content",r.target.value),placeholder:"Partagez votre opinion...",rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:bg-gray-700 dark:text-white",required:!0}),b.content&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:b.content}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{type:"submit",disabled:p||!h.content.trim(),className:"bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Publication...":"Publier le commentaire"})})]})}):e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-6 text-center mb-8",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Connectez-vous pour laisser un commentaire"}),e.jsx(u,{href:route("login"),className:"bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition",children:"Se connecter"})]}),e.jsx("div",{className:"space-y-6",children:g.length>0?g.map(r=>e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r.user.name}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400 text-sm",children:new Date(r.created_at).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed",children:r.content})]}),s.user&&(s.user.id===r.user.id||["admin","webmaster"].includes(s.user.role))&&e.jsx("button",{onClick:()=>S(r.id),className:"text-red-600 hover:text-red-800 p-1 rounded transition",title:"Supprimer le commentaire",children:"üóëÔ∏è"})]})},r.id)):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Aucun commentaire pour le moment. Soyez le premier √† commenter !"})})})]})]})]})}export{R as default};
